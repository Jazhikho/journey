<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Journey</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes fade-in {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .animate-fade-in {
      animation: fade-in 0.5s ease-in;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // Simple SVG icon components to replace lucide-react
    const Clock = ({ className, size = 16 }) => (
      <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 16 14"></polyline>
      </svg>
    );

    const Zap = ({ className, size = 16 }) => (
      <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
      </svg>
    );

    const Package = ({ className, size = 16 }) => (
      <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <line x1="16.5" y1="9.4" x2="7.5" y2="4.21"></line>
        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
        <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
        <line x1="12" y1="22.08" x2="12" y2="12"></line>
      </svg>
    );

    const JourneyGame = () => {
      const [gameState, setGameState] = useState('start');
      const [walkingState, setWalkingState] = useState('walking');
      const [resources, setResources] = useState({ time: 12, energy: 10, supplies: 8 });
      const [choices, setChoices] = useState({ helped: 0, continued: 0, explored: 0, rested: 0 });
      const [currentEncounter, setCurrentEncounter] = useState(null);
      const [journeyLog, setJourneyLog] = useState([]);
      const [usedEncounters, setUsedEncounters] = useState([]);
      const [encounterCount, setEncounterCount] = useState(0);
      const [parallaxOffset, setParallaxOffset] = useState(0);
      const [currentReflection, setCurrentReflection] = useState([]);
      const [reflectionLines, setReflectionLines] = useState([]);
      const reflectionIndexRef = useRef(0);
      const reflectionTimeoutRef = useRef(null);

      const encounters = [
        {
          id: 1,
          title: "The Asking Stranger",
          description: "Someone approaches you asking for money. Their clothes are worn but clean. They say it's for food, but there's a liquor store nearby. You can't know for certain.",
          minResources: { time: 0, energy: 0, supplies: 2 },
          choices: [
            { text: "Give them what they asked for", cost: { supplies: 2 }, type: 'helped', message: "They thank you and walk away.\n\nYou'll never know what they used it for.\n\nMaybe that's not the point." },
            { text: "Offer to buy them a meal instead", cost: { time: 2, energy: 1, supplies: 1 }, type: 'helped', message: "They hesitate, then accept.\n\nOver food, you learn they're a veteran.\n\nThe conversation is awkward but real." },
            { text: "Apologize and keep walking", cost: { energy: 1 }, gain: { time: 1 }, type: 'continued', message: "They nod without surprise.\n\nYou wonder if your caution is wisdom or excuse." }
          ]
        },
        {
          id: 2,
          title: "The Shortcut",
          description: "A gap in a fence reveals a path through private property. It would save considerable time. No one seems to be around. A sign says 'No Trespassing' but the grass is already worn from others' footsteps.",
          minResources: { time: 1, energy: 1, supplies: 0 },
          choices: [
            { text: "Take the shortcut", cost: { energy: 1 }, gain: { time: 3 }, type: 'continued', message: "You slip through quickly. Efficient.\n\nThe rules weren't really for people like you anyway...\n\nWere they?" },
            { text: "Walk around the long way", cost: { time: 3 }, gain: { energy: 1 }, type: 'explored', message: "The longer path winds past a creek.\n\nYou wouldn't have seen this.\n\nTime spent isn't always time lost." },
            { text: "Sit and rest here a moment", cost: { time: 1, energy: 0 }, gain: { energy: 2 }, type: 'rested', message: "You rest at the crossroads.\n\nSometimes not choosing is its own choice." }
          ]
        },
        {
          id: 3,
          title: "A Friend's Request",
          description: "Your phone buzzes. A friend asks you to tell their partner they were with you last night. They weren't. They don't explain why they need this lie, but they've helped you before.",
          minResources: { time: 1, energy: 1, supplies: 0 },
          choices: [
            { text: "Agree to cover for them", cost: { energy: 2 }, gain: { supplies: 1 }, type: 'helped', message: "You send the lie.\n\nLoyalty is complicated.\n\nYou hope you don't regret this." },
            { text: "Say you're not comfortable with that", cost: { time: 1, energy: 1 }, type: 'continued', message: "They go quiet.\n\nThe friendship feels different now.\n\nBut so do you." },
            { text: "Ask them what's really going on", cost: { time: 2, energy: 1 }, gain: { energy: 1 }, type: 'explored', message: "The truth is messier than you expected.\n\nAt least now you understand.\n\nEven if you can't help." }
          ]
        },
        {
          id: 4,
          title: "Found Money",
          description: "A folded bill lies on the ground. It's not insignificant. There's no one obviously looking for it. It could belong to anyone—someone who won't miss it, or someone who will.",
          minResources: { time: 0, energy: 0, supplies: 0 },
          choices: [
            { text: "Pocket it and move on", gain: { supplies: 3 }, type: 'continued', message: "Finders keepers.\n\nIt's what most people would do.\n\nThat's not a justification, just a fact." },
            { text: "Look around for who might have dropped it", cost: { time: 3, energy: 1 }, type: 'helped', message: "No one claims it.\n\nYou leave it with a nearby shopkeeper.\n\nMaybe it'll find its owner. Maybe not." },
            { text: "Leave it where it lies", cost: { time: 0 }, type: 'continued', message: "Not yours to take, not yours to steward.\n\nYou walk on, strangely lighter." }
          ]
        },
        {
          id: 5,
          title: "Uninvited Help",
          description: "An elderly person struggles with grocery bags, but they haven't asked for assistance. They might appreciate help. They might resent the implication they need it.",
          minResources: { time: 1, energy: 1, supplies: 0 },
          choices: [
            { text: "Offer to help carry their bags", cost: { time: 2, energy: 2 }, gain: { supplies: 1 }, type: 'helped', message: "They accept stiffly at first, then warm up.\n\nBy the end, they're telling you about their grandchildren." },
            { text: "Hold the door open as they pass", cost: { time: 1, energy: 0 }, type: 'helped', message: "Small gesture, no presumption.\n\nThey nod thanks.\n\nSometimes less is enough." },
            { text: "Trust them to ask if they need help", cost: { energy: 1 }, type: 'continued', message: "Respect for autonomy, or convenient justification?\n\nOnly you know which." }
          ]
        },
        {
          id: 6,
          title: "The Lonely Vendor",
          description: "A street vendor tries to catch your eye. Their wares are things you don't need. Business seems slow. Buying something would help them but clutter your journey.",
          minResources: { time: 1, energy: 0, supplies: 2 },
          choices: [
            { text: "Buy something small", cost: { time: 1, supplies: 2 }, gain: { energy: 1 }, type: 'helped', message: "Their face brightens.\n\nYou carry something useless that somehow feels meaningful." },
            { text: "Stop and chat without buying", cost: { time: 2, energy: 1 }, type: 'explored', message: "They seem grateful for the company.\n\nThough a flicker of hope dims when you don't buy.\n\nConnection isn't currency, except when it is." },
            { text: "Pretend not to notice them", cost: { energy: 1 }, type: 'continued', message: "Eyes forward.\n\nYou can't help everyone.\n\nThe weight of that truth sits differently each time." }
          ]
        },
        {
          id: 7,
          title: "The Group Activity",
          description: "People are gathered in a park doing tai chi. They wave you over to join. You weren't planning to stop, and you don't know anyone there.",
          minResources: { time: 2, energy: 1, supplies: 0 },
          choices: [
            { text: "Join in despite feeling awkward", cost: { time: 3, energy: 1 }, gain: { energy: 3, supplies: 1 }, type: 'explored', message: "You stumble through the movements.\n\nSomeone laughs kindly, adjusts your arm.\n\nYou leave feeling strangely connected to strangers." },
            { text: "Watch from a respectful distance", cost: { time: 2 }, gain: { energy: 1 }, type: 'rested', message: "There's peace in observation.\n\nNot everything needs to be participated in to be appreciated." },
            { text: "Wave back and continue on", cost: { time: 0 }, type: 'continued', message: "The invitation lingers in your mind.\n\nWhat would have happened if you'd said yes?" }
          ]
        },
        {
          id: 8,
          title: "Past Rudeness",
          description: "You recognize someone who was dismissive to you recently—nothing cruel, just thoughtless. Now they're struggling to reach something on a high shelf.",
          minResources: { time: 1, energy: 1, supplies: 0 },
          choices: [
            { text: "Help them without mentioning the past", cost: { time: 1, energy: 1 }, gain: { energy: 1 }, type: 'helped', message: "They don't recognize you.\n\nYour kindness exists independent of their awareness.\n\nIs that better or worse?" },
            { text: "Help them and make sure they remember you", cost: { time: 2, energy: 2 }, type: 'helped', message: "Recognition dawns. They apologize, embarrassed.\n\nIt feels good, then feels petty that it feels good." },
            { text: "Walk past and let someone else help", cost: { time: 0 }, gain: { time: 1 }, type: 'continued', message: "Someone else helps them.\n\nThe universe doesn't require you specifically.\n\nThat's freeing or disappointing depending on the day." }
          ]
        },
        {
          id: 9,
          title: "Your Own Needs",
          description: "You're tired. There's a quiet spot to rest, but you told someone you'd meet them soon. You'll still make it if you push through, just more drained.",
          minResources: { time: 2, energy: 0, supplies: 0 },
          choices: [
            { text: "Rest and text that you'll be late", cost: { time: 3 }, gain: { energy: 4 }, type: 'rested', message: "They say it's fine.\n\nYou can't tell if they mean it.\n\nBut you needed this." },
            { text: "Push through to keep your word", cost: { energy: 3 }, gain: { time: 1 }, type: 'continued', message: "You arrive on time, depleted.\n\nThey don't notice your sacrifice.\n\nShould they have to?" },
            { text: "Cancel entirely and take real time for yourself", cost: { time: 2, supplies: 1 }, gain: { energy: 5 }, type: 'rested', message: "Guilt mixes with relief.\n\nSelf-care and selfishness share a blurry border." }
          ]
        },
        {
          id: 10,
          title: "The Long Conversation",
          description: "An elderly neighbor wants to talk. They're lonely, you can tell. The conversation will be long and meandering. Your day has other plans.",
          minResources: { time: 2, energy: 2, supplies: 0 },
          choices: [
            { text: "Give them your full attention", cost: { time: 4, energy: 2 }, gain: { supplies: 2, energy: 1 }, type: 'helped', message: "An hour passes.\n\nThey show you photos, tell stories.\n\nYour schedule is ruined. Your heart is full." },
            { text: "Chat briefly then make an excuse", cost: { time: 2, energy: 1 }, type: 'helped', message: "You give what you can.\n\nThey seem to understand.\n\nEveryone is busy. That's just how it is now." },
            { text: "Wave and say you're running late", cost: { energy: 2 }, type: 'continued', message: "Their face falls slightly before recovering.\n\nYou weren't wrong—you are running late.\n\nThe truth can still be a small cruelty." }
          ]
        },
        {
          id: 11,
          title: "The Ambitious Detour",
          description: "A sign points to a viewpoint 'worth the climb.' It would take significant time and energy. You may never pass this way again.",
          minResources: { time: 3, energy: 3, supplies: 1 },
          choices: [
            { text: "Make the climb", cost: { time: 4, energy: 3, supplies: 1 }, gain: { energy: 2 }, type: 'explored', message: "The view is beautiful.\n\nOr maybe it isn't—but you'll always know now.\n\nNo more wondering." },
            { text: "Take a photo of the sign for 'someday'", cost: { time: 1 }, type: 'continued', message: "Your phone is full of 'somedays.'\n\nThis one joins them.\n\nPerhaps someday will come. It usually doesn't." },
            { text: "Ask someone coming down if it's worth it", cost: { time: 2, energy: 1 }, type: 'explored', message: "'Depends on what you're looking for,' they say.\n\nThat's not helpful.\n\nThat's the most helpful thing anyone's said all day." }
          ]
        },
        {
          id: 12,
          title: "The Injured Animal",
          description: "A cat limps in an alley. It might be a stray, might be someone's pet. Helping could take hours. The cat might bite. The cat might die anyway.",
          minResources: { time: 2, energy: 2, supplies: 2 },
          choices: [
            { text: "Try to help it yourself", cost: { time: 3, energy: 3, supplies: 2 }, gain: { supplies: 1 }, type: 'helped', message: "It scratches you before accepting help.\n\nYou get it to a shelter. They can't promise anything.\n\nYou did what you could." },
            { text: "Call animal services and wait with it", cost: { time: 4, energy: 1 }, type: 'helped', message: "They take an hour to arrive.\n\nThe cat watches you with uncertain eyes.\n\nWitness isn't nothing." },
            { text: "Hope someone better equipped comes along", cost: { energy: 2 }, type: 'continued', message: "You walk away carrying the image.\n\nMaybe someone helped. You could have. You didn't.\n\nBoth things are true." }
          ]
        }
      ];

      const maxEncounters = 10;

      useEffect(() => {
        if (gameState === 'playing') {
          const interval = setInterval(() => {
            setParallaxOffset(prev => prev + 1);
          }, 50);
          return () => clearInterval(interval);
        }
      }, [gameState]);

      useEffect(() => {
        if (gameState === 'playing' && walkingState === 'walking' && encounterCount < maxEncounters) {
          const minTime = 3000;
          const maxTime = 6000;
          const randomDelay = Math.random() * (maxTime - minTime) + minTime;
          
          const timeout = setTimeout(() => {
            const available = getAvailableEncounters();
            if (available.length > 0) {
              const encounter = available[Math.floor(Math.random() * available.length)];
              setCurrentEncounter(encounter);
              setWalkingState('encounter');
            } else {
              setGameState('ended');
            }
          }, randomDelay);

          return () => clearTimeout(timeout);
        }
      }, [gameState, walkingState, encounterCount, resources, usedEncounters]);

      // Effect to handle reflection display
      useEffect(() => {
        // Clear any existing timeout
        if (reflectionTimeoutRef.current) {
          clearTimeout(reflectionTimeoutRef.current);
          reflectionTimeoutRef.current = null;
        }
        
        // Only run when we enter reflecting state
        if (walkingState === 'reflecting') {
          // Check if we have lines to show
          if (reflectionLines.length > 0) {
            // Reset reflection state
            setCurrentReflection([]);
            reflectionIndexRef.current = 0;
            
            // Capture the lines array
            const linesToShow = [...reflectionLines];
            
            const showNextLine = () => {
              const currentIndex = reflectionIndexRef.current;
              
              if (currentIndex < linesToShow.length) {
                // Add the current line
                setCurrentReflection(prev => [...prev, linesToShow[currentIndex]]);
                reflectionIndexRef.current = currentIndex + 1;
                
                // Schedule next line or completion
                if (reflectionIndexRef.current < linesToShow.length) {
                  reflectionTimeoutRef.current = setTimeout(showNextLine, 1500);
                } else {
                  // All lines shown, wait 2 seconds then return to walking
                  reflectionTimeoutRef.current = setTimeout(() => {
                    setWalkingState('walking');
                    setCurrentReflection([]);
                    setReflectionLines([]);
                    reflectionIndexRef.current = 0;
                  }, 2000);
                }
              }
            };
            
            // Start showing the first line after 100ms
            reflectionTimeoutRef.current = setTimeout(showNextLine, 100);
          }
          
          // Cleanup function
          return () => {
            if (reflectionTimeoutRef.current) {
              clearTimeout(reflectionTimeoutRef.current);
              reflectionTimeoutRef.current = null;
            }
          };
        } else {
          // Reset when not reflecting
          setCurrentReflection([]);
          reflectionIndexRef.current = 0;
        }
      }, [walkingState, reflectionLines]);

      const getAvailableEncounters = () => {
        return encounters.filter(e => {
          if (usedEncounters.includes(e.id)) return false;
          return Object.keys(e.minResources).every(
            resource => resources[resource] >= e.minResources[resource]
          );
        });
      };

      const makeChoice = (choice) => {
        let newResources = { ...resources };
        
        if (choice.cost) {
          Object.keys(choice.cost).forEach(resource => {
            newResources[resource] = Math.max(0, newResources[resource] - choice.cost[resource]);
          });
        }
        
        if (choice.gain) {
          Object.keys(choice.gain).forEach(resource => {
            newResources[resource] = newResources[resource] + choice.gain[resource];
          });
        }

        setResources(newResources);

        const newChoices = { ...choices };
        newChoices[choice.type]++;
        setChoices(newChoices);

        setJourneyLog([...journeyLog, {
          title: currentEncounter.title,
          choice: choice.text,
          message: choice.message
        }]);

        setUsedEncounters([...usedEncounters, currentEncounter.id]);
        const newCount = encounterCount + 1;
        setEncounterCount(newCount);
        setCurrentEncounter(null);

        const lines = choice.message.split('\n\n').filter(line => line.trim());
        // Set both states - React will batch them, but the effect will run after both are set
        setReflectionLines(lines);
        setWalkingState('reflecting');

        setTimeout(() => {
          const tempResources = { ...newResources };
          const available = encounters.filter(e => {
            if ([...usedEncounters, currentEncounter.id].includes(e.id)) return false;
            return Object.keys(e.minResources).every(
              resource => tempResources[resource] >= e.minResources[resource]
            );
          });

          if (newCount >= maxEncounters || available.length === 0) {
            setTimeout(() => {
              setGameState('ended');
            }, lines.length * 1500 + 2000);
          }
        }, 100);
      };

      const startGame = () => {
        setGameState('playing');
        setWalkingState('walking');
        setResources({ time: 12, energy: 10, supplies: 8 });
        setChoices({ helped: 0, continued: 0, explored: 0, rested: 0 });
        setJourneyLog([]);
        setUsedEncounters([]);
        setEncounterCount(0);
        setCurrentEncounter(null);
        setParallaxOffset(0);
        setCurrentReflection([]);
        setReflectionLines([]);
      };

      const ResourceDisplay = () => (
        <div className="flex gap-3 justify-center">
          <div className="flex items-center gap-2 bg-slate-900 bg-opacity-70 px-3 py-2 rounded-lg border border-slate-700">
            <Clock className="text-blue-300" size={16} />
            <span className="font-semibold text-blue-100 text-sm">{resources.time}</span>
          </div>
          <div className="flex items-center gap-2 bg-slate-900 bg-opacity-70 px-3 py-2 rounded-lg border border-slate-700">
            <Zap className="text-amber-300" size={16} />
            <span className="font-semibold text-amber-100 text-sm">{resources.energy}</span>
          </div>
          <div className="flex items-center gap-2 bg-slate-900 bg-opacity-70 px-3 py-2 rounded-lg border border-slate-700">
            <Package className="text-emerald-300" size={16} />
            <span className="font-semibold text-emerald-100 text-sm">{resources.supplies}</span>
          </div>
        </div>
      );

      const WalkingScene = () => {
        const bgOffset1 = (parallaxOffset * 0.3) % 800;
        const bgOffset2 = (parallaxOffset * 0.5) % 600;
        const bgOffset3 = (parallaxOffset * 0.8) % 400;
        const legSwing = Math.sin(parallaxOffset * 0.2) * 5;

        return (
          <div className="relative w-full h-full overflow-hidden">
            <div className="absolute inset-0 bg-gradient-to-b from-slate-700 via-slate-800 to-slate-900"></div>
            
            <div className="absolute bottom-0 w-full h-64" style={{ transform: `translateX(-${bgOffset1}px)` }}>
              <svg className="absolute bottom-0" width="2400" height="256" style={{ left: 0 }}>
                <path d="M0,256 L0,180 L200,120 L400,160 L600,100 L800,140 L1000,80 L1200,130 L1400,90 L1600,150 L1800,110 L2000,170 L2200,130 L2400,180 L2400,256 Z" 
                      fill="#1e293b" opacity="0.5"/>
              </svg>
              <svg className="absolute bottom-0" width="2400" height="256" style={{ left: 800 }}>
                <path d="M0,256 L0,180 L200,120 L400,160 L600,100 L800,140 L1000,80 L1200,130 L1400,90 L1600,150 L1800,110 L2000,170 L2200,130 L2400,180 L2400,256 Z" 
                      fill="#1e293b" opacity="0.5"/>
              </svg>
            </div>

            <div className="absolute bottom-20 w-full h-48" style={{ transform: `translateX(-${bgOffset2}px)` }}>
              {[...Array(20)].map((_, i) => (
                <div key={i} className="absolute bottom-0 flex flex-col items-center" style={{ left: `${i * 150}px` }}>
                  <div className="w-12 h-12 bg-slate-700 rounded-full"></div>
                  <div className="w-1 h-16 bg-slate-600 -mt-3"></div>
                </div>
              ))}
            </div>

            <div className="absolute bottom-0 w-full h-20" style={{ transform: `translateX(-${bgOffset3}px)` }}>
              <div className="w-full h-full bg-slate-800 relative">
                {[...Array(40)].map((_, i) => (
                  <div key={i} className="absolute top-0 h-1 bg-slate-700" 
                       style={{ left: `${i * 50}px`, width: '30px' }}></div>
                ))}
              </div>
            </div>

            <div className="absolute bottom-20 left-1/2 transform -translate-x-1/2">
              <svg width="60" height="80" viewBox="0 0 60 80">
                <rect x="27.5" y="28" width="5" height="18" rx="2" fill="#7a8694" 
                      transform={`rotate(${Math.sin(parallaxOffset * 0.2 + Math.PI) * 25} 30 28)`} />
                <rect x="27.5" y="50" width="5" height="22" rx="2" fill="#4a5568" 
                      transform={`rotate(${-legSwing} 30 50)`} />
                <circle cx="30" cy="15" r="10" fill="#cbd5e1" />
                <rect x="23" y="25" width="14" height="25" rx="3" fill="#94a3b8" />
                <rect x="27.5" y="50" width="5" height="22" rx="2" fill="#64748b" 
                      transform={`rotate(${legSwing} 30 50)`} />
                <rect x="27.5" y="28" width="5" height="18" rx="2" fill="#94a3b8" 
                      transform={`rotate(${Math.sin(parallaxOffset * 0.2) * 25} 30 28)`} />
              </svg>
            </div>

          </div>
        );
      };

      const EndSummary = () => {
        const totalChoices = choices.helped + choices.continued + choices.explored + choices.rested;
        
        let reflection = "";
        const helpRatio = totalChoices > 0 ? choices.helped / totalChoices : 0;
        const exploreRatio = totalChoices > 0 ? choices.explored / totalChoices : 0;
        const restRatio = totalChoices > 0 ? choices.rested / totalChoices : 0;
        const continueRatio = totalChoices > 0 ? choices.continued / totalChoices : 0;

        if (helpRatio > 0.4) {
          reflection = "You moved through the world with your hands open. Whether from genuine compassion or the need to be needed—does the distinction matter to those you helped? Perhaps only to you.";
        } else if (exploreRatio > 0.35) {
          reflection = "You chose experience over efficiency. The detours, the conversations, the moments of presence. Life happened in the margins of your journey, not despite them.";
        } else if (restRatio > 0.3) {
          reflection = "You honored your own limitations. Some call it self-care, others call it knowing yourself. The journey continued because you didn't break yourself making it.";
        } else if (continueRatio > 0.5) {
          reflection = "You kept moving. Eyes forward, purpose intact. There's something to be said for that—for not being derailed by every pull on your attention. Something lost too, perhaps.";
        } else {
          reflection = "You found no single pattern, no easy label. Some moments you gave, others you took. Some you engaged, others you let pass. This is how most of us move through the world—inconsistently, humanly.";
        }

        return (
          <div className="max-w-2xl mx-auto bg-slate-800 bg-opacity-90 rounded-lg shadow-2xl p-8 text-slate-100">
            <h2 className="text-3xl font-light text-center mb-8 text-slate-200">The Path Behind You</h2>
            
            <div className="mb-8 p-6 bg-slate-700 bg-opacity-50 rounded-lg border border-slate-600">
              <p className="text-lg text-slate-300 leading-relaxed">{reflection}</p>
            </div>

            <div className="grid grid-cols-2 gap-4 mb-8">
              <div className="bg-slate-700 bg-opacity-50 p-4 rounded-lg text-center">
                <div className="text-3xl font-light text-pink-400">{choices.helped}</div>
                <div className="text-sm text-slate-400">Moments of giving</div>
              </div>
              <div className="bg-slate-700 bg-opacity-50 p-4 rounded-lg text-center">
                <div className="text-3xl font-light text-blue-400">{choices.explored}</div>
                <div className="text-sm text-slate-400">Moments of curiosity</div>
              </div>
              <div className="bg-slate-700 bg-opacity-50 p-4 rounded-lg text-center">
                <div className="text-3xl font-light text-amber-400">{choices.rested}</div>
                <div className="text-sm text-slate-400">Moments of stillness</div>
              </div>
              <div className="bg-slate-700 bg-opacity-50 p-4 rounded-lg text-center">
                <div className="text-3xl font-light text-slate-400">{choices.continued}</div>
                <div className="text-sm text-slate-400">Moments of forward motion</div>
              </div>
            </div>

            <div className="mb-8 p-4 bg-slate-700 bg-opacity-30 rounded-lg">
              <h3 className="text-sm text-slate-400 mb-4 text-center">What You Carried to the End</h3>
              <div className="flex gap-6 justify-center">
                <div className="text-center">
                  <div className="text-2xl font-light text-blue-300">{resources.time}</div>
                  <div className="text-xs text-slate-500">Time</div>
                </div>
                <div className="text-center">
                  <div className="text-2xl font-light text-amber-300">{resources.energy}</div>
                  <div className="text-xs text-slate-500">Energy</div>
                </div>
                <div className="text-center">
                  <div className="text-2xl font-light text-emerald-300">{resources.supplies}</div>
                  <div className="text-xs text-slate-500">Supplies</div>
                </div>
              </div>
            </div>

            <div className="text-center text-sm text-slate-500 mb-8">
              <p>There are no wrong answers. Only the ones you chose,</p>
              <p>and the person they reveal you to be today.</p>
            </div>

            <button
              onClick={startGame}
              className="w-full bg-slate-700 hover:bg-slate-600 text-slate-200 py-3 rounded-lg font-light transition-all border border-slate-600"
            >
              Walk Another Path
            </button>
          </div>
        );
      };

      if (gameState === 'ended') {
        return (
          <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-8 flex items-center justify-center">
            <EndSummary />
          </div>
        );
      }

      if (gameState === 'start') {
        return (
          <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-8 flex items-center justify-center">
            <div className="text-center max-w-lg">
              <h1 className="text-5xl font-light mb-6 text-slate-200">The Journey</h1>
              <p className="text-lg text-slate-400 mb-4">
                You are traveling. Along the way, you will encounter moments that ask something of you.
              </p>
              <p className="text-slate-500 mb-8">
                There are no right answers. There is no winning. There is only the path, and the choices you make walking it.
              </p>
              <button
                onClick={startGame}
                className="bg-slate-700 hover:bg-slate-600 text-slate-200 px-8 py-4 rounded-lg text-xl font-light transition-all border border-slate-600"
              >
                Begin
              </button>
            </div>
          </div>
        );
      }

      return (
        <div className="relative min-h-screen bg-slate-900 overflow-hidden">
          <div className="absolute inset-0">
            <WalkingScene />
          </div>

          <div className="relative z-10 p-6">
            <ResourceDisplay />
          </div>

          {walkingState === 'encounter' && currentEncounter && (
            <div className="absolute inset-0 flex items-center justify-center z-20 bg-slate-900 bg-opacity-80">
              <div className="max-w-2xl w-full mx-4">
                <div className="bg-slate-800 bg-opacity-95 rounded-lg shadow-2xl p-8 border border-slate-700">
                  <h2 className="text-2xl font-light mb-4 text-slate-200">{currentEncounter.title}</h2>
                  <p className="text-slate-400 mb-8 leading-relaxed">{currentEncounter.description}</p>

                  <div className="space-y-3">
                    {currentEncounter.choices.map((choice, index) => (
                      <button
                        key={index}
                        onClick={() => makeChoice(choice)}
                        className="w-full text-left p-4 rounded-lg border border-slate-600 hover:border-slate-400 hover:bg-slate-700 transition-all text-slate-300 hover:text-slate-100"
                      >
                        {choice.text}
                      </button>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          )}

          {walkingState === 'reflecting' && reflectionLines.length > 0 && (
            <div className="absolute inset-0 flex items-center justify-center z-30 pointer-events-none">
              <div className="bg-slate-900 bg-opacity-80 p-8 rounded-lg border border-slate-600 max-w-lg">
                {currentReflection.length === 0 ? (
                  <p className="text-slate-300 text-lg italic">...</p>
                ) : (
                  currentReflection.map((line, i) => (
                    <p key={i} className="text-slate-300 text-lg mb-4 last:mb-0 animate-fade-in italic">
                      {line}
                    </p>
                  ))
                )}
              </div>
            </div>
          )}
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<JourneyGame />);
  </script>
</body>
</html>

